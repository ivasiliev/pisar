# Писарь
Программа для генерации документов ВС РФ.

Можно создавать группы документов:
* Служебное разбирательство по факту грубого дисциплинарного проступка (ГДП)
	* Служебное разбирательство (сам документ)
	* Протокол о ГДП
	* Акт о невозможности получения копии протокола о ГДП
	* Акт о невозможности взять объяснение
	* Служебная характеристика
	
* Служебное разбирательство по факту cамовольного оставления части (СОЧ)
	* Административное расследование по факту самовольного оставления части
	* Лист согласования
	* Письмо родственникам
	* Ориентировка
	* Приказ
	* Приказ Копия
	* Служебная карточка
	* Служебная характеристика
	* Справка
	
* Массовая генерация документов
	* Справка из отдела кадров
	* Служебная характеристика
	
* Утилиты
	* Вычисление дней рождения личного состава на месяц вперед и назад
	* Сверка ШР и ЛС с выдачей списков пропущенных военнослужащих
	* Сортировка ЛС согласно списку строк в ШР
	
* Дневник психолого-педагогических наблюдений
	* Индивидуальные данные военнослужащего (для каждого)
	* Дни рождения
	* Нарушение воинской дисциплины
	
* Анкета прибывшего в зону СВО
	
## Установка для Windows
Необходимо установить программное обеспечение (нужны права администратора):
* Python 3.10. Среда исполнения. Нужна именно 3.10, потому что более старшие версии имеют проблему совместимости с библиотекой. [Скачать](https://www.python.org/ftp/python/3.10.0/python-3.10.0-amd64.exe). На первом окне, что появляется во время установки, поставьте галочку "Add to PATH...". Это позволит запускать скрипты из командной строки.
* Git. Через эту систему контроля версий будут скачиваться обновления. [Скачать](https://github.com/git-for-windows/git/releases/download/v2.41.0.windows.1/Git-2.41.0-64-bit.exe)	

Проверить правильность установки программного обеспечения можно так:
* В командной строке наберите: python --version. Будет напечатана строка: Python 3.10.
* В командной строке наберите: git --version. Будет напечатана строка: git version ... (установленная версия).


Установка Писаря происходит так:
1. Откройте поиск в Windows (значок лупы в левом нижнем углу, рядом с кнопкой "Пуск"). Наберите "cmd" и нажмите Enter. Запустится командная строка (черный экран с курсором).
2. Скопируйте: git clone https://github.com/ivasiliev/pisar.git c:/pisar
3. На командной строке (черный экран) нажмите правую кнопку мыши. Строка будет вставлена. Нажмите Enter.
4. Появится служебная информация касательно скачанных файлов и Писарь появится в `c:\pisar`.
5. Через Проводник Windows зайдите в папку `c:\pisar\pisar\install\`.
6. Двойным кликом левой кнопки мыши запустите файл `install.bat`.
7. Этот командный файл создаст две папки: `c:\pisar_data\` и `c:\pisar_output\`. В первую папку скопирует файлы настройки для документов и демо Штатного расписания. Вторая папка пуста: в ней будут создаваться сгенерированные документы. Помимо папок, командный файл установит необходимые библиотеки.
8. Кликните правой кнопкой мыши на файл `pisar.bat`, выберите "Отправить", "На рабочий стол (создать ярлык)".


Теперь Писарь готов к запуску.

## Начало работы
Двойным кликом левой кнопки мыши запустите ярлык на Рабочем столе (pisar.bat) либо же сам командный файл. Откроется командная строка (черный экран), а поверх него -- окно приложения. Не закрывайте командную строку! Все действия Писаря происходят в ней, а приложение лишь оболочка.

В приложении есть кнопка "Обновить". Рекомендуется запускать регулярное обновление программы. При этом в командной строке будет выведена информация. После обновления программы, перезапустите её. Тогда изменения вступят в силу.

Рядом с ней находятся кнопки "Войсковая часть" и "Военнослужащий". Нажатие на кнопку открывает соответствующий файл настройки. Оба файла находятся в каталоге C:\pisar_data\. Файл для военной части содержит общие реквизиты, используемые во всех документах. Файл для военнослужащего содержит информацию для конкретного человека, на которого создаются документы.

### Настройки "Войсковая часть" 
(файл common_info.json)
* `personnel_path`. Путь к файлу Excel со Штатным расписанием ("personnel" переводится как "личный состав"). Вместе с Писарем поставляется демонстрационный набор данных. Все имена вымышлены. Нужно создать собственный файл с теми же столбцами и указать путь к нему. Максимальное количество военнослужащих в Штатном расписании составляет 2000.
* `personnel_details_path`. Путь к файлу Excel с информацией о военнослужащих.
* `output_path`. Путь к каталогу, где будут созданы документы.
* `military_unit`. Номер войсковой части.
* `military_unit_address`. Адрес войсковой части.
* `is_guard`. Если часть гвардейская, то True. Иначе, False. Это нужно для правильного вычисления званий военнослужащих.
* `battalion`. Батальон.
* `phone_contact_to_report`. Номер телефона, по которому следует сообщить о самовольно оставившем войсковую часть.
* `hr_officer`. Сведения о специалисте отдела кадров.
* `clerk`. Сведения о делопроизводителе.
* `commander_1_level`, `commander_2_level`, `commander_3_level`, `commander_4_level`. Сведения о вышестоящих командирах.
* `row_limit`. Ограничение по количеству обрабатываемых строк в ШР и ЛС для утилит. 0 означает без ограничения, все строки.

### Настройки "Военнослужащий"
(файл soldier_info.json)
* `soldier_ids`. В Штатном расписании первая колонка содержит номера военнослужащих. Здесь нужно указать номер одного или нескольких военнослужащих.
* `date_of_event`. Дата происшествия в формате "ДД.ММ.ГГГГ".
* `commander_platoon`. Сведения о командире взвода. 
* `commander_company`. Сведения о командире роты.
* `commander_company_deputy_1`. Сведения о заместителе командира роты по военно-политической работе.
* `commander_squad`. Сведения о командире отделения.

Файл содержит больше полей, но следует заполнять только приведенные выше.

## Файлы данных
Программа поставляется с демонстрационными файлами (персоналии вымышлены):
* `personnel-demo.xlsx`. Штатное расписание.
* `personnel-details-demo.xlsx`. Информация о военнослужащих. Данные военнослужащих в обоих файлах сводятся по "Личный номер".

В обоих файлах данные полностью представлены только для первых трёх военнослужащих.

Данные из файлов настройки и Штатного расписания не передаются на другие компьютеры.

В званиях следует писать "рядовой", "лейтенант" и т.п., не прибавляя "гвардии". Это будет сделано автоматически.

Для командиров взводов и рот нет нужды указывать номер взвода и роты. Они будут взяты из Штатного расписания относительно заданного военнослужащего.

Когда файлы настройки готовы, нажмите кнопку "Запуск" и наблюдайте за окном с командной строкой. Там отображается подробная информация о создании документов. В случае успеха, документы появятся в каталоге `c:\pisar_output\`. В названии документа в скобках указано имя военнослужащего, которому он посвящён.

Если командир роты или взвода не задан, то будет выведена "заглушка" в виде [ФИО РОТНОГО КОМАНДИРА] и подобных. В таком случае сведения надо внести вручную. 

После генерации документов, внимательно их проверьте. Рекомендуется скопировать полученные документы в другую папку, потому что при следующей генерации они будут перезаписаны без дополнительных уведомлений.

**Ни при каких обстоятельствах не пересылайте Штатное расписание либо другие "чувствительные" данные разработчикам программы.**

## Известные проблемы и недостатки

* В документе "Протокол о ГДП" необходимо вручную ввести подчеркивания в нужные строки.
* Некоторые слова склоняются неверно. Например, "стрелок". Необходимо проверять документы после генерации.
* Пока не удалось найти простого и удобного способа соединить военнослужащего с его командирами взвода и роты. Потому эти настройки из Штатного расписания перенесены в файл настройки.

## Обновления программы

**2.7 | 11.07.2025**

* Актуализация шапки ЛС.

**2.6 | 15.04.2025**

* Добавлен шаблон "Без вести пропавший" для Коробки.

**2.5 | 08.04.2025**

* Исправление ошибок.

**2.4 | 05.04.2025**

* Исправлена ошибка с подстановкой поля "Телефон".


**2.3 | 03.04.2025**

* Сторонний компонент PySimpleGui, который используется для графического интерфейса, больше не поддерживается разработчиками и нуждается в замене. Это будет в следующей версии. Пока же в скрипте установки путь к нему заменён на резервный сервер.

* В каталог C:\pisar_data\box добавлен новый шаблон Справка-объективка.docx с подстановочными местами. Обновлённый список подстановочных места можно увидеть в файле cheatsheet.txt

**2.2 | 01.08.2024**

* Улучшено вычисление хэш-функции для военнослужащего.

**2.1 | 22.06.2024**

* Исправлены ошибки в шаблонах.

**2.0 | 17.06.2024**

* Новая утилита "Коробка" (подстановочные места в документе). Шаблоны для СОЧ находятся в data\templates. Там же есть файл cheatsheet.txt в доступными командами.

**1.20 | 27.05.2024**

* Демо новой утилиты "Коробка" (подстановочные места в документе).

**1.19 | 20.05.2024**

* Актуализация утилиты Сортировка.

**1.18.1 | 14.05.2024**

* Добавлено логирование. Логи появляются в директории pisar_output\logs.

**1.18 | 13.05.2024**

* Актуализация модуля "Самовольное оставление части (СОЧ)".
* Исправлены ошибки в утилите Сверка.

**1.17 | 20.03.2024**

* Актуализация модуля "Служебное разбирательство по факту грубого дисциплинарного проступка (ГДП)".
* Исправлены ошибки с предлогами, что оставались в предыдущей строке.
* В файл настройки "Военнослужащий" добавлены заместитель командира роты по военно-политической работе и командир отделения.

**1.16.5 | 07.01.2024**

* Обновление шапки ЛС до состояния на 07 января 2024 г.

**1.16 | 03.12.2023**
* Обновление шапки ЛС до состояния на 03 декабря 2023 г.
* Новый документ "Анкета прибывшего в зону СВО".

**1.15 | 26.10.2023**
* Исправлена ошибка чтения файла с большим количеством столбцов.

**1.14 | 19.08.2023**
* Дневник психолого-педагогических наблюдений.

**1.13 | 06.08.2023**
* Обновления в утилитах Дни рождения и Сверка ШР и ЛС.
* Новая утилита "Сортировка ЛС по порядку строк в ШР".

**1.12 | 28.07.2023**
* Обновлена шапка документа ЛС.
* Добавлена новая настройка `row_limit` в файл common_info.json.
* Утилита, что возвращает грядущие дни рождения военнослужащих, что будут в течение следующих 30 дней. Утилита работает со столбцом "Дата рождения" в документе ШР.
* Утилита, что сверяет списки военнослужащих в документах ШР и ЛС. Военнослужащие без личных номеров в сверке не участвуют.

**1.11 | 22.07.2023**
* В ШР вместо номеров роты, взвода, отделения следует писать полный текст. Например, "3 стрелковая рота". См. файл personnel-demo.xslx для примера.
* Номера военнослужащих в поле soldier_ids можно задавать через запятую, например: 1,2,3. Либо через тире, например: 1-3. В этом случае будут обработаны номера 1,2,3. Можно смешивать оба способа: 1,2-3.
* Добавлены Массовая генерация Справки (из отдела кадров) и Служебной характеристики. Документы будут созданы для всех военнослужащих, заданных в soldier_ids. При этом они будут помещены в единый каталог, без разбивки в подкаталоги по именам людей. Этим способом удобно создавать документы для всего личного состава. Например, если задать в soldier_ids значение "1-200", то для военнослужащих с номерами п/п в ШР от 1 до 200 будут созданы эти документы.

**1.10 | 18.07.2023**
* Поддержка дополнительного Excel-документа с информацией о военнослужащих.
* В полной мере заработала генерация документов для нескольких военнослужащих одновременно.

**1.9 | 02.07.2023**

* Документы выгружаются в подкаталог с ФИО военнослужащего. Подкаталоги по-прежнему располагаются в `c:\pisar_output\`.
* Каждый офицер из файла настройки "Войсковая часть", а также взводный и ротный из файла настройки "Военнослужащий" имеют личный признак `is_guard` (гвардеец = True, не гвардеец = False). Войсковая часть также имеет этот признак. 


**1.8 | 30.06.2023**

* Добавлена группа "Служебное разбирательство по факту cамовольного оставления части" и 9 документов в ней.
* Добавлены новые ключи в файлы конфигурации для поддержки группы документов "Служебное разбирательство по факту cамовольного оставления части".

**1.7 | 27.06.2023**

* Добавлена новая группа "Служебное разбирательство по факту cамовольного оставления части" и её первый документ "Административное расследование по факту самовольного оставления части".
* В настройки Войсковой части добавлены ключи: батальон и номер телефона (см. выше в списке параметров).

**1.6 | 26.06.2023**

* В группу "Служебное разбирательство по факту грубого дисциплинарного проступка" добавлен документ "Протокол о ГДП".
* Отныне вместо одного файла настройки используются два: soldier_info.json (данные о военнослужащем) и common_info.json (данные о войсковой части).
* Правильное склонение имён военнослужащих женского пола.

**1.5 | 23.06.2023**

* Оптимизирован поиск военнослужащего.
* Добавлен файл personnel_data_massive.xlsx с 2000 военнослужащих. Данные созданы случайным образом.

**1.4 | 20.06.2023**

* Исправлена ошибка с названием листа. Было "ШБС", стало -- "ШДС".
* Расшифровка аббревиатуры ВРИО в документе "Служебное разбирательство" в резолютивной части и правильное склонение.
* Исправлена ошибка с поиском несуществующего военнослужащего.

**1.3 | 15.06.2023**

* Отныне в файле Штатного расписания обязан присутствовать лист `ШДС`. На этом листе следует расположить таблицу с данными военнослужащих. Остальные листы книги Excel игнорируются. Файл personnel_demo.xlsx имеет правильную структуру.
* Существенно улучшена производительность программы при работе с большими файлами Штатного расписания.
* Нормализация имён военнослужащих. Например, "ФРОЛОВ ЕВГЕНИЙ МИХАЙЛОВИЧ" будет преобразован в "Фролов Евгений Михайлович". Это преобразование происходит только для людей из Штатного расписания.
* При обновлении программы файл personnel_demo.xlsx копируется в C:\pisar_data. Будьте осторожны -- это может перезаписать ваши данные. Не следует изменять файл personnel_demo.xlsx, поскольку он используется как образец. 
* При обновлении программа проверяет версию. Если версия изменилась, то в командной строке выводится приглашение перезапустить программу. Что и следует сделать.

**1.2 | 13.06.2023**

Отныне в номерах рот можно указывать буквы и цифры. Исправлена ошибка с чтением дат из ШР. Поддерживаются ячейки типа "Дата".

**1.1 | 10.06.2023**

Исправлена ошибка с неверным путем к файлу настройки.

**1.0 | 08.06.2023**

Первая версия

	
